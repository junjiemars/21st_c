
nm_feature="endian"
nm_feature_name="nm_have_little_endian"
nm_feature_run=value
nm_feature_h="#include <stdio.h>"
nm_feature_flags=
nm_feature_inc=
nm_feature_ldlibs=
nm_feature_test='int i=0x11223344;
                 char *p = (char *)&i;
            		 int le = (0x44 == *p);
                 printf("%d", le);'
. ${NORE_ROOT}/auto/feature


nm_include="stdint.h" . ${NORE_ROOT}/auto/include


nm_include="inttypes.h" . ${NORE_ROOT}/auto/include


nm_include="stdbool.h" . ${NORE_ROOT}/auto/include


nm_feature="sizeof(void*)"
nm_feature_name="nm_ptr_len"
nm_feature_run=value
nm_feature_h="#include <stdio.h>"
nm_feature_flags=
nm_feature_inc=
nm_feature_ldlibs=
nm_feature_test='void* p; printf("%zu", sizeof p);'
. ${NORE_ROOT}/auto/feature


nm_feature="sizeof(size_t)"
nm_feature_name="nm_size_t_len"
nm_feature_flags=
nm_feature_run=value
nm_feature_h="#include <stdio.h>"
nm_feature_flags=
nm_feature_inc=
nm_feature_ldlibs=
nm_feature_test='printf("%zu", sizeof(size_t)*8);'
. ${NORE_ROOT}/auto/feature


nm_feature="variable-length array"
nm_feature_name="nm_have_vla"
nm_feature_flags=
nm_feature_run=no
nm_feature_h=
nm_feature_flags=
nm_feature_inc=
nm_feature_ldlibs=
nm_feature_test='int size; int buffer[size];'
. ${NORE_ROOT}/auto/feature


# check features based on OS
#----------------------------------------
case $NM_SYSTEM in
	Darwin)
		nm_feature="malloc_size fn"
		nm_feature_name="nm_have_malloc_size_fn"
		nm_feature_run=no
		nm_feature_h='#include <malloc/malloc.h>
                  #include <stdlib.h>'
		nm_feature_flags=
		nm_feature_inc=
		nm_feature_ldlibs=
		nm_feature_test='int *p=malloc(16*sizeof(*p));
                     malloc_size(p);
                     free(p);'
		. ${NORE_ROOT}/auto/feature
	  ;;
	Linux)
		nm_feature="malloc_size fn"
		nm_feature_name="nm_have_malloc_size_fn"
		nm_feature_run=no
		nm_feature_h='#include <malloc.h>
                  #include <stdlib.h>'
		nm_feature_flags=
		nm_feature_inc=
		nm_feature_ldlibs=
		nm_feature_test='int *p=malloc(16*sizeof(*p));
                     malloc_usable_size(p);
                     free(p);'
		. ${NORE_ROOT}/auto/feature
	  ;;
	WinNT)
		nm_feature="malloc_size fn"
		nm_feature_name="nm_have_malloc_size_fn"
		nm_feature_run=no
		nm_feature_h='#include <stdlib.h>'
		nm_feature_flags=
		nm_feature_inc=
		nm_feature_ldlibs=
		nm_feature_test='int *p=malloc(16*sizeof(*p));
                     _mize(p);
                     free(p);'
		. ${NORE_ROOT}/auto/feature		
	  ;;
	*)
	  ;;
esac

