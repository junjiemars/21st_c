

CL_BIN_PATH=${CL_PREFIX%/}/${CL_BIN_PATH%/}
CL_LIB_PATH=${CL_PREFIX%/}/${CL_LIB_PATH%/}
CL_CONF_PATH=${CL_PREFIX%/}/${CL_CONF_PATH%/}
CL_INC_PATH=${CL_PREFIX%/}/${CL_INC_PATH%/}
CL_PID_PATH=${CL_PREFIX%/}/${CL_PID_PATH%/}
CL_LOG_PATH=${CL_PREFIX%/}/${CL_LOG_PATH%/}


# append install target

cat << END >> $CL_MAKEFILE

#---------------------------------------


prefix_dirs:
	mkdir -p $CL_BIN_PATH
	mkdir -p $CL_LIB_PATH
	mkdir -p $CL_CONF_PATH
	mkdir -p $CL_INC_PATH
	mkdir -p $CL_PID_PATH
	mkdir -p $CL_LOG_PATH


bin_files := \$(wildcard $CL_OBJS/bin/*)
lib_files := \$(wildcard $CL_OBJS/lib/*)
conf_files := \$(wildcard $CL_OBJS/conf/*)
inc_files := \$(wildcard $CL_OBJS/inc/*)



install: build | prefix_dirs
	\$(foreach f,\$(bin_files),\$(shell cp \$(f) $CL_BIN_PATH/))
	\$(foreach f,\$(lib_files),\$(shell cp \$(f) $CL_LIB_PATH/))
	\$(foreach f,\$(conf_files),\$(shell cp \$(f) $CL_CONF_PATH/))
	\$(foreach f,\$(inc_files),\$(shell cp \$(f) $CL_INC_PATH/))



END



# create Makefile

cat << END >> Makefile

build:
	\$(MAKE) -f $CL_MAKEFILE

install: 
	\$(MAKE) -f $CL_MAKEFILE install

END


